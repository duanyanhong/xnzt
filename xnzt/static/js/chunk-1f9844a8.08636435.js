(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f9844a8"],{"241f":function(t,e,a){"use strict";a("ee24")},"8c21":function(t,e,a){"use strict";(function(t){a("14d9"),a("e9c4"),a("b64b"),a("ac1f"),a("5319"),a("313d"),a("0eb6"),a("b7ef"),a("8bd4");var o=a("b20f"),l=a("ac55"),i=a("3122");e["a"]={name:"Allocation",components:{OrderDetail:l["default"],AddOrderDetail:i["default"]},data:function(){return{searchData:{limit:20,page:1,createTime:[],ownerId:[],allocationOrderCode:"",fromLogicwarehouseId:[],toLogicwarehouseId:[],allocationType:[],orderState:[],exceptionType:[],createUserAccount:[],accessToken:sessionStorage.getItem("xn_token")},owners:[],logicwarehouses:[],createUsers:[],ids:[],pageSizes:[20,50,100],dataList:[],total:0,searchIsshow:!1,searchContent:"",titlesContent:"",searchType:"",loading:!1,formIsshow:!1,formDetailIsshow:!1,detailData:[],detailInfo:[],addDetailInfo:[],jsHeight:500}},mounted:function(){this.searchData.createTime=this.$commonApi.calculateTimeRange("pastWeek"),this.loadData()},activated:function(){var t=this;this.$nextTick((function(){t.$refs.plTable.doLayout()}))},methods:{loadData:function(){var e=this;this.loading=!0,Object(o["f"])(this.searchData).then((function(a){a&&(e.loading=!1,e.dataList=a.msgData.list.items,e.total=a.msgData.list.total,e.owners=a.msgData.owners,e.logicwarehouses=a.msgData.logicwarehouses,e.createUsers=a.msgData.createUsers,e.jsHeight=window.innerHeight-t(".head-container").outerHeight()-t(".crud-opts").outerHeight()-180)}))},handleSelectionChange:function(t){this.ids=[];for(var e=0;e<t.length;e++)this.ids.push(t[e].id)},search:function(){this.page=1,this.loadData()},downMyOrder:function(){var t=this;this.loading=!0,Object(o["d"])(this.searchData).then((function(e){t.loading=!1,e&&(t.$modal.notifySuccess(e.errMsg),void 0!==e.msgData.downloadUrl&&""!==e.msgData.downloadUrl&&(window.location.href=e.msgData.downloadUrl),t.loadData())}))},searchShow:function(t,e){this.searchContent=this.searchData[t].replace(/,/g,"\n"),this.searchType=t,this.titlesContent=e,this.searchIsshow=!0},addSearchForm:function(){this.searchData[this.searchType]=this.searchContent.replace(/\n/g,",").replace("，",","),this.searchIsshow=!1},addShow:function(){this.addDetailInfo=[],this.formIsshow=!0},editStaff:function(t){var e=this;this.detailData=t,Object(o["e"])({id:this.detailData.id,accessToken:sessionStorage.getItem("xn_token")}).then((function(t){if(t){e.detailInfo=JSON.parse(JSON.stringify(t.msgData.items));for(var a=0;a<e.detailInfo.length;a++){var o=e.detailInfo[a].skuCode+e.detailInfo[a].skuState+e.detailInfo[a].batchNo;e.detailInfo[a].uniqueId=btoa(unescape(encodeURIComponent(o)))}e.formDetailIsshow=!0}}))},addDetailForm:function(){var t=this;if(this.detailInfo.length<1)this.$modal.notifyWarning("请先添加明细！");else{var e={id:this.detailData.id,details:this.detailInfo,accessToken:sessionStorage.getItem("xn_token")};Object(o["b"])(e).then((function(e){e&&(t.$modal.notifySuccess(e.errMsg),t.formDetailIsshow=!1)}))}},uploadSuccess:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("file",t.file),a.append("accessToken",sessionStorage.getItem("xn_token")),Object(o["h"])(a).then((function(t){e.loading=!1,t&&(e.$modal.notifySuccess(t.errMsg),void 0!==t.msgData.downloadUrl&&""!==t.msgData.downloadUrl&&(window.location.href=t.msgData.downloadUrl),e.loadData())}))},examineAllocation:function(){var t=this,e=this;this.ids.length<1?this.$message({title:"错误",message:"请选择要操作的数据",duration:3e3,type:"error"}):e.$confirm("确定要操作选中数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["c"])({ids:t.ids,accessToken:sessionStorage.getItem("xn_token")}).then((function(e){e&&(t.$modal.notifySuccess(e.errMsg),t.loadData())}))})).catch((function(){}))},removeAllocation:function(){var t=this,e=this;this.ids.length<1?this.$message({title:"错误",message:"请选择要操作的数据",duration:3e3,type:"error"}):e.$confirm("确定要操作选中数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["j"])({ids:t.ids,accessToken:sessionStorage.getItem("xn_token")}).then((function(e){e&&(t.$modal.notifySuccess(e.errMsg),t.loadData())}))})).catch((function(){}))},interceptAllocation:function(){var t=this,e=this;this.ids.length<1?this.$message({title:"错误",message:"请选择要操作的数据",duration:3e3,type:"error"}):e.$confirm("确定要操作选中数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["i"])({ids:t.ids,accessToken:sessionStorage.getItem("xn_token")}).then((function(e){e&&(t.$modal.notifySuccess(e.errMsg),t.loadData())}))})).catch((function(){}))}}}}).call(this,a("1157"))},9959:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",[a("div",{staticClass:"head-container"},[a("div",[a("date-range-picker",{staticClass:"date-item",staticStyle:{width:"350px !important","margin-right":"10px"},attrs:{clearable:!1},model:{value:t.searchData.createTime,callback:function(e){t.$set(t.searchData,"createTime",e)},expression:"searchData.createTime"}}),a("div",{staticClass:"filter-item my-select"},[a("SelectToolbar",{staticStyle:{width:"180px",display:"inline-block"},attrs:{placeholder:"请选择货主",filterable:!1,isfilte:!0,fiftervalue:t.searchData.ownerId,bindId:"ownerId",bindName:"ownerName",fifteroptions:t.owners},model:{value:t.searchData.ownerId,callback:function(e){t.$set(t.searchData,"ownerId",e)},expression:"searchData.ownerId"}})],1),a("div",{staticClass:"filter-item"},[a("el-input",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"输入调拨单单号",clearable:""},model:{value:t.searchData.allocationOrderCode,callback:function(e){t.$set(t.searchData,"allocationOrderCode",e)},expression:"searchData.allocationOrderCode"}},[a("el-button",{attrs:{slot:"suffix",type:"text"},on:{click:function(e){return t.searchShow("allocationOrderCode","输入调拨单单号")}},slot:"suffix"},[a("svg-icon",{staticStyle:{background:"#fff","vertical-align":"0"},attrs:{"icon-class":"plus"}})],1)],1)],1),a("div",{staticClass:"filter-item my-select"},[a("SelectToolbar",{staticStyle:{width:"180px",display:"inline-block"},attrs:{placeholder:"请选择原逻辑仓库",filterable:!1,isfilte:!0,fiftervalue:t.searchData.fromLogicwarehouseId,bindId:"logicwarehouseId",bindName:"logicwarehouseName",fifteroptions:t.logicwarehouses},model:{value:t.searchData.fromLogicwarehouseId,callback:function(e){t.$set(t.searchData,"fromLogicwarehouseId",e)},expression:"searchData.fromLogicwarehouseId"}})],1),a("div",{staticClass:"filter-item my-select"},[a("SelectToolbar",{staticStyle:{width:"180px",display:"inline-block"},attrs:{placeholder:"请选择目标逻辑仓库",filterable:!1,isfilte:!0,fiftervalue:t.searchData.toLogicwarehouseId,bindId:"logicwarehouseId",bindName:"logicwarehouseName",fifteroptions:t.logicwarehouses},model:{value:t.searchData.toLogicwarehouseId,callback:function(e){t.$set(t.searchData,"toLogicwarehouseId",e)},expression:"searchData.toLogicwarehouseId"}})],1),a("div",{staticClass:"filter-item my-select"},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择调拨类型",multiple:"",clearable:"","collapse-tags":""},model:{value:t.searchData.allocationType,callback:function(e){t.$set(t.searchData,"allocationType",e)},expression:"searchData.allocationType"}},[a("el-option",{attrs:{label:"仓间调拨",value:"仓间调拨"}}),a("el-option",{attrs:{label:"仓内调拨",value:"仓内调拨"}}),a("el-option",{attrs:{label:"仓店调拨",value:"仓店调拨"}})],1)],1),a("div",{staticClass:"filter-item my-select"},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择订单状态",multiple:"","collapse-tags":"",clearable:""},model:{value:t.searchData.orderState,callback:function(e){t.$set(t.searchData,"orderState",e)},expression:"searchData.orderState"}},[a("el-option",{attrs:{label:"待审核",value:"待审核"}}),a("el-option",{attrs:{label:"待出库",value:"待出库"}}),a("el-option",{attrs:{label:"已出库",value:"已出库"}}),a("el-option",{attrs:{label:"待入库",value:"待入库"}}),a("el-option",{attrs:{label:"已入库",value:"已入库"}}),a("el-option",{attrs:{label:"出库中",value:"出库中"}}),a("el-option",{attrs:{label:"入库中",value:"入库中"}}),a("el-option",{attrs:{label:"已作废",value:"已作废"}})],1)],1),a("div",{staticClass:"filter-item my-select"},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择异常类型",multiple:"",clearable:"","collapse-tags":""},model:{value:t.searchData.exceptionType,callback:function(e){t.$set(t.searchData,"exceptionType",e)},expression:"searchData.exceptionType"}},[a("el-option",{attrs:{label:"入库异常",value:"入库异常"}}),a("el-option",{attrs:{label:"审核异常",value:"审核异常"}}),a("el-option",{attrs:{label:"拦截异常",value:"拦截异常"}}),a("el-option",{attrs:{label:"出库异常",value:"出库异常"}}),a("el-option",{attrs:{label:"同步异常",value:"同步异常"}}),a("el-option",{attrs:{label:"删除异常",value:"删除异常"}})],1)],1),a("div",{staticClass:"filter-item my-select"},[a("SelectToolbar",{staticStyle:{width:"180px",display:"inline-block"},attrs:{placeholder:"请选择创建用户",filterable:!1,isfilte:!0,fiftervalue:t.searchData.createUserAccount,bindId:"createUserAccount",bindName:"createUserName",fifteroptions:t.createUsers},model:{value:t.searchData.createUserAccount,callback:function(e){t.$set(t.searchData,"createUserAccount",e)},expression:"searchData.createUserAccount"}})],1),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")])],1)]),a("div",{staticClass:"crud-opts"},[a("span",{staticClass:"crud-opts-left"},[t._t("left"),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Add"],expression:"['Stock:Allocation:Add']"}],staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.addShow}},[t._v(" 新增 ")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Examine"],expression:"['Stock:Allocation:Examine']"}],staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-finished",plain:""},on:{click:t.examineAllocation}},[t._v(" 审核 ")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Remove"],expression:"['Stock:Allocation:Remove']"}],staticClass:"filter-item",attrs:{size:"mini",type:"danger",icon:"el-icon-delete",plain:""},on:{click:t.removeAllocation}},[t._v(" 删除 ")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Intercept"],expression:"['Stock:Allocation:Intercept']"}],staticClass:"filter-item",attrs:{size:"mini",type:"warning",icon:"el-icon-s-promotion",plain:""},on:{click:t.interceptAllocation}},[t._v(" 拦截 ")])],2),a("span",{staticClass:"crud-opts-left"},[a("el-upload",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Import"],expression:"['Stock:Allocation:Import']"}],staticClass:"inline-block",attrs:{"show-file-list":!1,"http-request":t.uploadSuccess,accept:".xlsx,.xls,.csv",action:"#"}},[a("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-upload2",size:"mini"}},[t._v("导入")])],1)],1),a("span",{staticClass:"crud-opts-left"},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Export"],expression:"['Stock:Allocation:Export']"}],staticClass:"filter-item",attrs:{size:"mini",type:"warning",icon:"el-icon-download",plain:""},on:{click:t.downMyOrder}},[t._v("导出")])],1)]),a("u-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"plTable",attrs:{data:t.dataList,height:t.jsHeight,"use-virtual":"","row-height":50,stripe:"","header-cell-style":{background:"#f8f8f9",color:"#515a6e",fontSize:"13px",height:"45px",border:"none"},"cell-style":{border:"none"}},on:{"selection-change":t.handleSelectionChange}},[a("u-table-column",{attrs:{type:"selection",width:"55"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"allocationOrderCode",label:"调拨订单"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"fromLogicwarehouseName",label:"原逻辑仓库"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"toLogicwarehouseName",label:"目标逻辑仓库"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ownerName",label:"货主"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"orderState",label:"订单状态"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"allocationType",label:"调拨类型"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"exceptionType",label:"异常类型"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"exceptionDesc",label:"异常描述"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"createTime",label:"创建时间"}}),a("u-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"remark",label:"备注"}}),a("u-table-column",{attrs:{label:"操作",align:"center",width:"125"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Preview"],expression:"['Stock:Allocation:Preview']"}],staticStyle:{width:"50px"},attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.editStaff(e.row)}}},[t._v("编辑明细")])]}}])})],1),a("pagination",{attrs:{limit:t.searchData.limit,page:t.searchData.page,total:t.total,"page-sizes":t.pageSizes},on:{"update:limit":function(e){return t.$set(t.searchData,"limit",e)},"update:page":function(e){return t.$set(t.searchData,"page",e)},"update:pageSizes":function(e){t.pageSizes=e},"update:page-sizes":function(e){t.pageSizes=e},pagination:t.loadData}})],1)],1),a("InputDialog",{attrs:{visible:t.searchIsshow,"search-content":t.searchContent,title:t.titlesContent},on:{"update:visible":function(e){t.searchIsshow=e},"update:searchContent":function(e){t.searchContent=e},"update:search-content":function(e){t.searchContent=e},"update:title":function(e){t.titlesContent=e},confirmed:t.addSearchForm}}),a("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,top:"8vh",visible:t.formDetailIsshow,title:"调拨单明细管理",width:"80%"},on:{"update:visible":function(e){t.formDetailIsshow=e}}},[a("OrderDetail",{attrs:{detailData:t.detailData,detailInfo:t.detailInfo},on:{"update:detailInfo":function(e){t.detailInfo=e},"update:detail-info":function(e){t.detailInfo=e}}}),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:Save"],expression:"['Stock:Allocation:Save']"},{name:"debounce",rawName:"v-debounce",value:t.addDetailForm,expression:"addDetailForm"}],attrs:{type:"primary"}},[t._v("保存")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.formDetailIsshow=!1}}},[t._v("取消")])],1)],1),a("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,top:"8vh",visible:t.formIsshow,title:"调拨单明细管理",width:"80%"},on:{"update:visible":function(e){t.formIsshow=e}}},[a("AddOrderDetail",{attrs:{logicwarehouses:t.logicwarehouses,owners:t.owners,formIsshow:t.formIsshow,addDetailInfo:t.addDetailInfo,loadData:t.loadData},on:{"update:formIsshow":function(e){t.formIsshow=e},"update:form-isshow":function(e){t.formIsshow=e},"update:addDetailInfo":function(e){t.addDetailInfo=e},"update:add-detail-info":function(e){t.addDetailInfo=e}}})],1)],1)},l=[],i=a("8c21"),s=i["a"],n=a("2877"),r=Object(n["a"])(s,o,l,!1,null,null,null);e["default"]=r.exports},ac55:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"650px","max-height":"650px"}},[a("div",[a("div",{staticStyle:{"font-weight":"bold","font-size":"15pt",height:"40px","line-height":"40px"}},[t._v(" 基础信息 ")]),a("div",{staticStyle:{"border-bottom":"1px solid #ccc","margin-bottom":"10px"}}),a("el-form",{ref:"formData",attrs:{inline:!0,size:"small","label-width":"100px"}},[a("el-form-item",{attrs:{label:"调拨订单"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.allocationOrderCode,callback:function(e){t.$set(t.detailData,"allocationOrderCode",e)},expression:"detailData.allocationOrderCode"}})],1),a("el-form-item",{attrs:{label:"调拨类型"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.allocationType,callback:function(e){t.$set(t.detailData,"allocationType",e)},expression:"detailData.allocationType"}})],1),a("el-form-item",{attrs:{label:"订单状态"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.orderState,callback:function(e){t.$set(t.detailData,"orderState",e)},expression:"detailData.orderState"}})],1),a("el-form-item",{attrs:{label:"来源平台"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.sourcePlatformCode,callback:function(e){t.$set(t.detailData,"sourcePlatformCode",e)},expression:"detailData.sourcePlatformCode"}})],1),a("el-form-item",{attrs:{label:"货主"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.ownerName,callback:function(e){t.$set(t.detailData,"ownerName",e)},expression:"detailData.ownerName"}})],1),a("el-form-item",{attrs:{label:"原逻辑仓库"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.fromLogicwarehouseName,callback:function(e){t.$set(t.detailData,"fromLogicwarehouseName",e)},expression:"detailData.fromLogicwarehouseName"}})],1),a("el-form-item",{attrs:{label:"目标逻辑仓库"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.toLogicwarehouseName,callback:function(e){t.$set(t.detailData,"toLogicwarehouseName",e)},expression:"detailData.toLogicwarehouseName"}})],1),a("el-form-item",{attrs:{label:"异常类型"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.exceptionType,callback:function(e){t.$set(t.detailData,"exceptionType",e)},expression:"detailData.exceptionType"}})],1),a("el-form-item",{attrs:{label:"异常描述"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.detailData.exceptionDesc,callback:function(e){t.$set(t.detailData,"exceptionDesc",e)},expression:"detailData.exceptionDesc"}})],1)],1)],1),a("div",[a("div",{staticStyle:{"font-weight":"bold","font-size":"15pt",height:"40px","line-height":"40px"}},[t._v(" 统计信息 ")]),a("div",{staticStyle:{"border-bottom":"1px solid #ccc","margin-bottom":"10px"}}),a("el-form",{ref:"formData",attrs:{inline:!0,size:"small","label-width":"100px"}},[a("el-form-item",{attrs:{label:"总行数"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.total.count,callback:function(e){t.$set(t.total,"count",e)},expression:"total.count"}})],1),a("el-form-item",{attrs:{label:"总数量"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.total.sum,callback:function(e){t.$set(t.total,"sum",e)},expression:"total.sum"}})],1),a("el-form-item",{attrs:{label:"总重量"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.total.weight,callback:function(e){t.$set(t.total,"weight",e)},expression:"total.weight"}})],1),a("el-form-item",{attrs:{label:"总体积"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:""},model:{value:t.total.volume,callback:function(e){t.$set(t.total,"volume",e)},expression:"total.volume"}})],1)],1),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:AddDetail"],expression:"['Stock:Allocation:AddDetail']"}],staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.addDetailInfoShow}},[t._v(" 新增明细 ")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["Stock:Allocation:RemoveDetail"],expression:"['Stock:Allocation:RemoveDetail']"}],staticClass:"filter-item",attrs:{size:"mini",type:"danger",icon:"el-icon-delete",plain:""},on:{click:t.delDetailInfo}},[t._v(" 删除明细 ")])],1),a("el-table",{staticStyle:{width:"100%","overflow-y":"auto"},attrs:{data:t.detailInfo,border:"",height:"300","row-height":10},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuCode",label:"商品编码"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuName",label:"商品名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuState",label:"库存状态"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"planQty",label:"请求数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"stockUnit",label:"单位"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"totalWeight",label:"总重量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"totalVolume",label:"总体积"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"lotNo",label:"批号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"batchNo",label:"批次"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"productDate",label:"生产日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"expireDate",label:"失效日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"shelfLife",label:"保质期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"shelfLifeUnit",label:"保质期单位"}})],1)],1),a("InputDialog",{attrs:{visible:t.searchIsshow,"search-content":t.searchContent,title:t.titlesContent},on:{"update:visible":function(e){t.searchIsshow=e},"update:searchContent":function(e){t.searchContent=e},"update:search-content":function(e){t.searchContent=e},"update:title":function(e){t.titlesContent=e},confirmed:t.addSearchForm}}),a("el-dialog",{staticClass:"custom-dialog",attrs:{"append-to-body":"","close-on-click-modal":!1,top:"8vh",visible:t.isFormDetailShow,center:"",title:"批量新增",width:"80%"},on:{"update:visible":function(e){t.isFormDetailShow=e}}},[a("div",{staticStyle:{height:"650px","max-height":"650px"}},[a("div",{staticClass:"head-container"},[a("div",{staticClass:"filter-item"},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"输入商品编码",clearable:""},model:{value:t.searchDetailData.skuCode,callback:function(e){t.$set(t.searchDetailData,"skuCode",e)},expression:"searchDetailData.skuCode"}},[a("el-button",{attrs:{slot:"suffix",type:"text"},on:{click:function(e){return t.searchShow("skuCode","输入商品编码")}},slot:"suffix"},[a("svg-icon",{staticStyle:{background:"#fff","vertical-align":"0"},attrs:{"icon-class":"plus"}})],1)],1)],1),a("div",{staticClass:"filter-item"},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"输入商品条码",clearable:""},model:{value:t.searchDetailData.barCode,callback:function(e){t.$set(t.searchDetailData,"barCode",e)},expression:"searchDetailData.barCode"}},[a("el-button",{attrs:{slot:"suffix",type:"text"},on:{click:function(e){return t.searchShow("barCode","输入商品条码")}},slot:"suffix"},[a("svg-icon",{staticStyle:{background:"#fff","vertical-align":"0"},attrs:{"icon-class":"plus"}})],1)],1)],1),a("div",{staticClass:"filter-item"},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"输入商品名称",clearable:""},model:{value:t.searchDetailData.skuName,callback:function(e){t.$set(t.searchDetailData,"skuName",e)},expression:"searchDetailData.skuName"}},[a("el-button",{attrs:{slot:"suffix",type:"text"},on:{click:function(e){return t.searchShow("skuName","输入商品名称")}},slot:"suffix"},[a("svg-icon",{staticStyle:{background:"#fff","vertical-align":"0"},attrs:{"icon-class":"plus"}})],1)],1)],1),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:t.searchDetail}},[t._v("搜索")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingStock,expression:"loadingStock"}],staticStyle:{width:"100%","overflow-y":"auto"},attrs:{data:t.stockDataList,border:"",height:"300","row-height":10}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuCode",label:"商品编码"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuName",label:"商品名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"usableQty",label:"可用数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"inWarehouseQty",label:"在库数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"assignQty",label:"分配数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"lockedQty",label:"锁定数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"inTransitQty",label:"在途数量"}}),a("el-table-column",{attrs:{align:"center",width:"160",label:"请求数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.row.planQty,callback:function(a){t.$set(e.row,"planQty",a)},expression:"scope.row.planQty"}})]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuState",label:"库存状态"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"lotNo",label:"批号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"batchNo",label:"批次"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"productDate",label:"生产日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"expireDate",label:"失效日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"shelfLife",label:"保质期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"shelfLifeUnit",label:"保质期单位"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(a){return t.addStock(e.row)}}},[t._v("添加")])]}}])})],1),a("div",[t._v(" 已选明细 ")]),a("el-table",{staticStyle:{width:"100%","overflow-y":"auto"},attrs:{data:t.selectData,border:"",height:"300","row-height":10}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuCode",label:"商品编码"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuName",label:"商品名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"skuState",label:"库存状态"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"planQty",label:"请求数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"stockUnit",label:"单位"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"lotNo",label:"批号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"batchNo",label:"批次"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"productDate",label:"生产日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"expireDate",label:"失效日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"shelfLife",label:"保质期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"shelfLifeUnit",label:"保质期单位"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-remove-outline"},on:{click:function(a){return t.addDel(e.$index)}}},[t._v("移除")])]}}])})],1)],1),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:t.addStockForm,expression:"addStockForm"}],attrs:{type:"primary"}},[t._v("确认")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isFormDetailShow=!1}}},[t._v("取消")])],1)])],1)},l=[],i=(a("4de4"),a("c740"),a("14d9"),a("a434"),a("e9c4"),a("b680"),a("b64b"),a("d3b7"),a("ac1f"),a("5319"),a("313d"),a("0eb6"),a("b7ef"),a("8bd4"),a("b20f")),s={props:{detailData:{type:Object,required:{}},detailInfo:{type:Array}},data:function(){return{total:{count:"",sum:"",weight:"",volume:""},ids:[],isFormDetailShow:!1,searchIsshow:!1,searchContent:"",titlesContent:"",searchType:"",searchDetailData:{skuCode:"",barCode:"",skuName:"",accessToken:sessionStorage.getItem("xn_token"),ownerId:"",fromLogicwarehouseId:""},stockDataList:[],selectData:[],loadingStock:!1}},watch:{detailInfo:{handler:function(t){this.getTotal()}}},activated:function(){},mounted:function(){this.getTotal()},methods:{handleSelectionChange:function(t){this.ids=[];for(var e=0;e<t.length;e++)this.ids.push(t[e])},getTotal:function(){this.total.count=this.detailInfo.length,this.total.sum=0,this.total.weight=0,this.total.volume=0;for(var t=0;t<this.detailInfo.length;t++)this.total.sum=this.total.sum+this.detailInfo[t].planQty,this.total.weight=this.total.weight+this.detailInfo[t].totalWeight,this.total.volume=this.total.volume+this.detailInfo[t].totalVolume;this.total.weight=this.total.weight.toFixed(2),this.total.volume=this.total.volume.toFixed(2)},delDetailInfo:function(){var t=this;if(this.ids.length<1)this.$modal.notifyWarning("请选择要操作数据！");else{var e=this.detailInfo.filter((function(e){return!t.ids.some((function(t){return e.uniqueId===t.uniqueId}))}));this.$emit("update:detailInfo",e)}},addDetailInfoShow:function(){for(var t in this.searchDetailData)"accessToken"!=t&&"ownerId"!=t&&"fromLogicwarehouseId"!=t&&(this.searchDetailData[t]="");this.isFormDetailShow=!0,this.stockDataList=[],this.selectData=[]},searchShow:function(t,e){this.searchContent=this.searchDetailData[t].replace(/,/g,"\n"),this.searchType=t,this.titlesContent=e,this.searchIsshow=!0},addSearchForm:function(){this.searchDetailData[this.searchType]=this.searchContent.replace(/\n/g,",").replace("，",","),this.searchIsshow=!1},searchDetail:function(){var t=this;this.loadingStock=!0,this.searchDetailData.ownerId=this.detailData.ownerId,this.searchDetailData.fromLogicwarehouseId=this.detailData.fromLogicwarehouseId,Object(i["g"])(this.searchDetailData).then((function(e){t.stockDataList=e.msgData.items,t.loadingStock=!1}))},addStock:function(t){if(void 0==t.planQty||t.planQty<1)this.$modal.notifyWarning("请选择录入请求数量！");else{var e=this.selectData.findIndex((function(e){return e.skuCode===t.skuCode&&e.skuState===t.skuState&&e.batchNo===t.batchNo}));-1==e?this.selectData.push(JSON.parse(JSON.stringify(t))):this.selectData[e].planQty+=t.planQty}},addDel:function(t){this.selectData.splice(t,1)},addStockForm:function(){var t=this;if(this.selectData.length<1)this.$modal.notifyWarning("请添加明细！");else{for(var e,a,o,l,i,s,n=function(n){e=t.selectData[n].skuCode+t.selectData[n].skuState+t.selectData[n].batchNo,a=btoa(unescape(encodeURIComponent(e))),o=t.detailInfo.findIndex((function(e){return e.skuCode===t.selectData[n].skuCode&&e.skuState===t.selectData[n].skuState&&e.batchNo===t.selectData[n].batchNo})),l=t.selectData[n].planQty*t.selectData[n].singleVolume,i=t.selectData[n].planQty*t.selectData[n].singleGrossWeight,-1==o?(t.total.count+=1,s={uniqueId:a,logicwarehouseId:t.detailData.fromLogicwarehouseId,barCode:t.selectData[n].barCode,skuCode:t.selectData[n].skuCode,skuName:t.selectData[n].skuName,skuState:t.selectData[n].skuState,planQty:t.selectData[n].planQty,stockUnit:t.selectData[n].stockUnit,totalWeight:i,totalVolume:l,lotNo:t.selectData[n].lotNo,batchNo:t.selectData[n].batchNo,productDate:t.selectData[n].productDate,expireDate:t.selectData[n].expireDate,shelfLife:t.selectData[n].shelfLife,shelfLifeUnit:t.selectData[n].shelfLifeUnit},t.detailInfo.push(s)):(t.detailInfo[o].planQty+=t.selectData[n].planQty,t.detailInfo[o].totalVolume+=l,t.detailInfo[o].totalWeight+=i)},r=0;r<this.selectData.length;r++)n(r);this.getTotal(),this.isFormDetailShow=!1}}}},n=s,r=(a("241f"),a("2877")),c=Object(r["a"])(n,o,l,!1,null,null,null);e["default"]=c.exports},ee24:function(t,e,a){}}]);